<html>
<head>

    <script src="js/jquery-1.10.2.min.js"> </script>
    <script src="js/jquery.color-2.1.2.min.js"> </script>
    <script src="js/chessboard-0.3.0.js"> </script>
    <script src="js/chess.js"> </script>
    <script src="js/music.js"> </script>
    <script src="js/games.js"> </script>
    <script src="js/beepboop.js"> </script>
    <script src="js/twoplayer.js"> </script>
    <link rel="stylesheet" href="css/chessboard-0.3.0.css" />
    <script>
    window.onload = init;
    var board;
    var chess_moves = new Chess();
    var current_move = 0;
    var cur_file = 0;
    var moves;
    var is_replay = false;
    var first_move = true;


    function init() {
        chess_moves.load_pgn(pgns[0].join('\n'));
        moves = chess_moves.history({verbose: true});
        setupMusic();

    }

    function replayGame() {
        is_replay = true;
        board = new ChessBoard('board1', 'start');
        setTimeout(movePiece, 1600);
    }

    function twoPlayer() {
        board = new ChessBoard('board1', cfg);
        updateStatus();
    }
    

    function movePiece() {
        i = current_move;
        if(i >= moves.length) {
            return;
        }
        board.move(moves[i].from +'-'+ moves[i].to);
        var rank = moves[i].from.substring(1,2);
        if (moves[i].san == "O-O") {
            if (rank == 1) {
                board.move('h1-f1');
            } else {
                board.move('h8-f8');
            }
        } else if (moves[i].san == "O-O-O") {
            if (rank == 1) {
                board.move('a1-d1');
            } else {
                board.move('a8-d8');
            }
        }
        if (unplayableSquares[moves[i].from] == 1) {
            delete unplayableSquares[moves[i].from];
        }
        playPosition(moves[i]);
        var text = $('#pgn').text();
        if (current_move % 2 == 0) {
            display_move = current_move / 2;
            display_move = display_move + 1;
            text = text + ' ' + display_move + '. ';
        }
        $('#pgn').text(text + ' ' + moves[i].san);
        
        current_move = current_move + 1;
    }

    </script>
</head>
<body>

<button onclick='twoPlayer()'>Two Player</button>
<button onclick='replayGame()'>Preloaded Game</button>
<div id="board1" style="width: 400px"></div>
<span id="pgn"></span>
<br/>
<span id="fen"></span>
<text id="status"></text>


</body>
</html>
